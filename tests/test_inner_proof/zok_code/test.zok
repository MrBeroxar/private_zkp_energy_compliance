from "ecc/decaf377.zok" import verifyEddsa;
import "utils/casts/u32_to_field.zok" as u32_to_field;

def main(private field[2] R1, private field S1, private field[2] R2, private field S2, private field[2] A, private u32[16] Consumption, private u32[16] Production, field netResult){
    assert(verifyEddsa(R1, S1, A, Consumption[0..8], Production[0..8]));
    assert(verifyEddsa(R2, S2, A, Consumption[8..16], Production[8..16]));

    u32 mut sumConsumption = 0;
    u32 mut sumProduction = 0;

    for u32 i in 0..16 {
        sumConsumption = sumConsumption + Consumption[i];
        sumProduction = sumProduction + Production[i];
    }
    field fieldSumConsumption = u32_to_field(sumConsumption);
    field fieldSumProduction = u32_to_field(sumProduction);
    field calculatedNetResult = fieldSumConsumption - fieldSumProduction;
    assert(calculatedNetResult == netResult);

}
